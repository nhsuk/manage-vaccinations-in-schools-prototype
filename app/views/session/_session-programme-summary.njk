{% set columnWidth = "fifth" if session.offersAlternativeVaccine else "quarter" %}

{% for programme in session.programmes %}
  {{ appHeading({
    title: programme.name,
    summary: __mf("session.tally.eligible.count", {
      count: session.tally(programme.id).eligible
    }),
    level: 3,
    size: "m"
  }) }}
  <div class="nhsuk-grid-row nhsuk-card-group">
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ConsentOutcome.NoResponse,
        heading: __("session.tally.noResponse.label"),
        headingLevel: 3,
        colour: "grey",
        compact: true,
        data: session.tally(programme.id).noResponse,
        href: session.uri + "/consent?consent=" + ConsentOutcome.NoResponse + "&programme_id=" + programme.id
      }) }}
    </div>
{% if programme.standardVaccine.criteria == VaccineCriteria.Intranasal %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.consentGivenForVaccineCriteria.label", {
          vaccineCriteria: programme.standardVaccine.criteria | lower
        }),
        colour: "green",
        compact: true,
        data: session.tally(programme.id).consentGiven,
        href: session.uri + "/consent?consent=" + ConsentOutcome.GivenForIntranasal
      }) }}
    </div>
{% else %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.consentGiven.label"),
        colour: "green",
        compact: true,
        data: session.tally(programme.id).consentGiven,
        href: session.uri + "/consent?consent=" + ConsentOutcome.Given
      }) }}
    </div>
{% endif %}
{% if programme.alternativeVaccine %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.consentGivenForVaccineCriteria.label", {
          vaccineCriteria: programme.alternativeVaccine.criteria | lower
        }),
        colour: "green",
        compact: true,
        data: session.tally(programme.id).consentGivenForAlternativeInjection,
        href: session.uri + "/consent?consent=" + ConsentOutcome.GivenForAlternativeInjection
      }) }}
    </div>
{% endif %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.didNotConsent.label"),
        headingLevel: 3,
        colour: "red",
        compact: true,
        data: session.tally(programme.id).didNotConsent,
        href: session.uri + "/consent?consent=" + ConsentOutcome.Refused + "&programme_id=" + programme.id
      }) }}
    </div>
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.vaccinated.label"),
        headingLevel: 3,
        compact: true,
        data: session.tally(programme.id).vaccinated,
        href: session.uri + "/report?report=" + PatientStatus.Vaccinated + "&programme_id=" + programme.id
      }) }}
    </div>
  </div>
{% endfor %}
