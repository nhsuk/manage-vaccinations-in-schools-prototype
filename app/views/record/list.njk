{% extends "_layouts/unbranded.njk" %}

{% set title = __("record.list.title") %}

{% block content %}
  {{ super() }}

  {{ heading({
    caption: __("record.list.caption"),
    size: "xl",
    title: title
  }) }}

  {% set resultRows = [] %}
  {% for record in results.page %}
    {% set resultRows = resultRows | push([
      {
        header: __("record.fullName.label"),
        html: link(record.uri, record.fullName) or "Not provided",
        attributes: {
          "data-sort": record.lastName
        }
      },
      {
        header: __("record.nhsn.label"),
        html: record.formatted.nhsn or "Not provided"
      },
      {
        header: __("record.dob.label"),
        html: record.formatted.dob or "Not provided",
        attributes: {
          "data-sort": record.dob
        }
      },
      {
        header: __("record.gender.label"),
        html: record.gender or "Not provided"
      }
    ]) %}
  {% endfor %}

  {{ actionTable({
    classes: "nhsuk-u-margin-bottom-6",
    id: "records",
    sort: "full name",
    caption: __n("record.count", records.length),
    responsive: true,
    head: [
      { text: __("record.fullName.label") },
      { text: __("record.nhsn.label") },
      { text: __("record.dob.label") },
      { text: __("record.gender.label") }
    ],
    rows: resultRows
  }) }}

  {{ govukPagination(pages) }}

  {{ __("record.results", { results: results }) | nhsukMarkdown }}
{% endblock %}
