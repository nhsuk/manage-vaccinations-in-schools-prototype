{% extends "_layouts/form.njk" %}

{% set title = __("session.consent-link.title") %}
{% set confirmButtonText = __("session.consent-link.confirm") %}
{% set paths = {
  back: "/sessions/" + session.id + "/consents/" + consent.uuid
} %}

{% block form %}
  {{ super() }}

  {{ heading({
    caption: __("session.consent-link.caption", { parent: consent.parent } ),
    title: title
  }) }}

  {{ table({
    panel: true,
    classes: "app-compare",
    tableClasses: "app-compare__table",
    caption: __("session.consent-link.summary"),
    captionClasses: "nhsuk-u-padding-top-4",
    firstCellIsHeader: true,
    head: [
      { html: "<span class=\"nhsuk-u-visually-hidden\">Field</span>" },
      { text: __("consent.label") },
      { text: __("record.label") }
    ],
    rows: [
      [
        { html: __("child.fullName.label") },
        { html: consent.child.fullName | highlightDifference(patient.fullName) },
        { text: patient.fullName }
      ],
      [
        { html: __("child.dob.label") },
        { html: consent.child.formatted.dob | highlightDifference(patient.record.formatted.dob) },
        { text: patient.record.formatted.dob }
      ],
      [
        { text: __("child.address.label") },
        { html: consent.child.formatted.address | highlightDifference(patient.record.formatted.address) },
        { html: patient.record.formatted.address }
      ],
      [
        { text: __("child.gpSurgery.label") },
        { html: consent.child.formatted.gpSurgery | highlightDifference(patient.record.formatted.gpSurgery) },
        { text: patient.record.formatted.gpSurgery }
      ]
    ]
  }) }}

  {{ card({
    heading: __("parent.label"),
    headingClasses: "nhsuk-heading-m",
    descriptionHtml: summaryList({
      rows: summaryRows(consent.parent, {
        fullName: {},
        relationship: {},
        hasParentalResponsibility: {},
        email: {},
        tel: {},
        contactPreference: {},
        sms: {}
      })
    })
  }) }}

  {{ card({
    heading: __("consent.label"),
    headingClasses: "nhsuk-heading-m",
    descriptionHtml: summaryList({
      rows: summaryRows(consent, {
        created: {},
        decision: {},
        refusalReason: {},
        refusalReasonDetails: {}
      })
    })
  }) }}
{% endblock %}
